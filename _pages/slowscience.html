<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.13">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Slow Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="slowscience_files/libs/clipboard/clipboard.min.js"></script>
<script src="slowscience_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="slowscience_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="slowscience_files/libs/quarto-html/popper.min.js"></script>
<script src="slowscience_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="slowscience_files/libs/quarto-html/anchor.min.js"></script>
<link href="slowscience_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="slowscience_files/libs/quarto-html/quarto-syntax-highlighting-66ab7fd5e73b7f0a764e0d49b3e29ab1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="slowscience_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="slowscience_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="slowscience_files/libs/bootstrap/bootstrap-c0367b04c37547644fece4185067e4a7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#scientific-papers" id="toc-scientific-papers" class="nav-link active" data-scroll-target="#scientific-papers">Scientific papers</a></li>
  <li><a href="#some-initiatives" id="toc-some-initiatives" class="nav-link" data-scroll-target="#some-initiatives">Some initiatives</a></li>
  <li><a href="#books-and-blogposts" id="toc-books-and-blogposts" class="nav-link" data-scroll-target="#books-and-blogposts">Books and blogposts</a>
  <ul class="collapse">
  <li><a href="#in-english" id="toc-in-english" class="nav-link" data-scroll-target="#in-english">In English</a></li>
  <li><a href="#in-french" id="toc-in-french" class="nav-link" data-scroll-target="#in-french">In French</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Slow Science</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-22FQGNH39N"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-22FQGNH39N');
</script>
<p>{% include toc %}</p>
<p>I recently gave a talk on Slow Science x Eco/Evo for <a href="https://www.sortee.org/">SORTEE</a>. <a href="https://events.humanitix.com/sortee-webinar-in-defense-of-depth-slow-science-for-sustainable-progress-in-ecology-and-evolution">[Webinar info]</a>. You can find the presentation <a href="/pdf/SlowScienceSORTEE.pdf" target="_blank"><b>[here]</b></a>.</p>
<p>A few years ago, I already had the opportunity to give a talk about Slow Science at the online conference <a href="https://livemeeg2020.org/">LiveMEEG2020</a> in October 2020. You can access my slides <a href="/pdf/SlowScience.pdf" target="_blank"><b>[here]</b></a> to have an overview of my presentation.</p>
<p>Below, I have added the various references and resources I could accumulate on the topic, as well as some existing initiatives that promote better / alternative ways of doing science. [latest update: Nov.&nbsp;2024]</p>
<section id="scientific-papers" class="level2">
<h2 class="anchored" data-anchor-id="scientific-papers">Scientific papers</h2>
<ul>
<li>Berg, L.D., Huijbens, E.H., Larsen, H.G. (2016). Producing anxiety in the neoliberal university. The Canadian Geographer / Le Géographe canadien, 60: 168-180. <a href="https://doi.org/10.1111/cag.12261">[DOI]</a></li>
<li>Brown NJL (2024) Fixing science means an end to gaming the system. PLOS Biology 22(9): e3002816. <a href="https://doi.org/10.1371/journal.pbio.3002816">[DOI]</a></li>
<li>Chapman, C. A., … &amp; Stenseth, N. C. (2019). Games academics play and their consequences: how authorship, h-index and journal impact factors are shaping the future of academia. Proceedings of the Royal Society B, 286: 20192047. <a href="https://royalsocietypublishing.org/doi/10.1098/rspb.2019.2047">[DOI]</a></li>
<li>Frith, U. (2019). Fast Lane to Slow Science. Trends in Cognitive Sciences. <a href="https://www.sciencedirect.com/science/article/pii/S1364661319302426">[DOI]</a></li>
<li>Hatch, A. and Curry, S. (2020). Research Culture: Changing how we evaluate research is difficult, but not impossible. eLife 2020;9:e58654 <a href="https://elifesciences.org/articles/58654">[DOI]</a></li>
<li>Lancaster, A.K., Thessen, A.E., Virapongse, A. (2018). A new paradigm for the scientific enterprise: nurturing the ecosystem. F1000 Research. <a href="https://f1000research.com/articles/7-803">[DOI]</a></li>
<li>Lane, S.N. (2017), Slow science, the geographical expedition, and Critical Physical Geography. The Canadian Geographer / Le Géographe canadien, 61: 84-101. <a href="https://doi.org/10.1111/cag.12329">[DOI]</a></li>
<li>Peake, L., &amp; Mullings, B. (2016). Critical Reflections on Mental and Emotional Distress in the Academy. ACME: An International Journal for Critical Geographies, 15(2), 253-284. <a href="https://www.acme-journal.org/index.php/acme/article/view/1123">[DOI]</a></li>
<li>Roche, DG, Bennett JR, Provencher J, Rytwinski T, Haddaway NR, Cooke SJ (2019). Environmental sciences benefit from robust evidence irrespective of speed. Science of The Total Environment, 696. <a href="https://doi.org/10.1016/j.scitotenv.2019.134000">[DOI]</a>.</li>
<li>Salo, P. &amp; Heikkinen, H.L.T. (2018). Slow Science: Research and Teaching for Sustainable Praxis. Confero, 6(1), 87-211. <a href="http://www.confero.ep.liu.se/article.asp?DOI=10.3384/confero.2001-4562.181130">[DOI]</a></li>
<li>Smaldino, P. E., &amp; McElreath, R. (2016). The natural selection of bad science. Royal Society Open Science, 3: 160384. <a href="https://royalsocietypublishing.org/doi/10.1098/rsos.160384">[DOI]</a></li>
<li>Vazire, S. (2017). Quality Uncertainty Erodes Trust in Science. Collabra: Psychology, 3(1), 1. <a href="https://www.collabra.org/articles/10.1525/collabra.74/">[DOI]</a></li>
<li>Ylijoki, O.-H., &amp; Mäntylä, H. (2003). Conflicting Time Perspectives in Academic Work. Time &amp; Society, 12(1), 55–78. <a href="https://doi.org/10.1177/0961463X03012001364">[DOI]</a></li>
</ul>
</section>
<section id="some-initiatives" class="level2">
<h2 class="anchored" data-anchor-id="some-initiatives">Some initiatives</h2>
<p>This list includes discussion groups on how to improve science that gather scholars from different disciplines, initiatives to promote and think about better research practices, alternative research institutes with a mix of ‘regular’ and independent scholars. - <a href="https://slowscience.be/">Slow Science in Belgium</a> is ‘an interuniversity platform for discussion on academia’s future’. - <a href="https://betterscience.ch/">Better Science in Switzerland</a> ‘calls for a rethinking in academia towards more sustainability, diversity and equal opportunities.’ - <a href="https://lac.ulb.ac.be/LAC/home.html">L’atelier des chercheur·e·s.</a> (Pour une desexcellence des universités) is a collective of academics in Brussels, Belgium sharing their thoughts and actions around the idea of ‘desexcellence’, very close to the concept of Slow science <a href="#in-french">in French</a>. - <a href="https://wellcome.org/what-we-do/our-work/research-culture/hosting-your-cafe-culture-discussion">Café Culture Initiative</a> by the Wellcome foundation and some results already about research culture as experienced by researchers that you can find <a href="https://wellcome.org/reports/what-researchers-think-about-research-culture">here</a>. - The <a href="https://hibar-research.org/">HIBAR Research Alliance</a> to improve research and innovation ecosystem and better contribute to solving society’s critical problems. You can find their discussion paper <a href="https://hibar-research.org/wp-content/uploads/2020/06/Making-changes-in-the-academic-incentive-system-June-3-2020.pdf">here</a>. - The <a href="https://sfdora.org">DORA</a> initiative, which promotos a different way of evaluating researchers than just using publication indices. It also has different incentives and guidelines depending on the targeted structure (universities, publishers, etc). - The <a href="http://ronininstitute.org/">RONIN institute</a> ‘is devoted to facilitating and promoting scholarly research outside traditional academic research institutions.’ - <a href="https://igdore.org/">IGDORE</a>, the institute for globally distributed open research and education ‘is an independent research institute dedicated to improving the quality of science, science education, and quality of life for scientists, students and their families.’ - <a href="https://researchcooperative.org/">The research cooperative</a> is a&nbsp;moderated&nbsp;social network dedicated to better academic, technical and educational communication. - <a href="https://picomps.org/">PiCompS</a>, Postdoctal institute for computational studies, is a virtual home for both independent and academic researchers, inspired by the Ronin Institute. They are ‘an international forum, a virtual community that recognizes the world outside of traditional academia. Their mission is to promote diversity in computing, raise awareness and provide support to independent researchers, scholars with alternative academic careers , and those who seek to redefine career.’</p>
</section>
<section id="books-and-blogposts" class="level2">
<h2 class="anchored" data-anchor-id="books-and-blogposts">Books and blogposts</h2>
<section id="in-english" class="level3">
<h3 class="anchored" data-anchor-id="in-english">In English</h3>
<ul>
<li>I recommend the medium channel of <a href="https://medium.com/@dunldj">Daniel J. Dunleavy</a> who writes interesting posts on slow science, open science, changes academia needs and so on. See, for instance, <a href="https://medium.com/@dunldj/fast-science-slow-science-finding-balance-in-the-time-of-covid-19-and-the-age-of-misinformation-b57946c523d7">this post</a> on “Fast Science, Slow Science: Finding Balance in the Time of COVID-19 and the Age of Misinformation.”</li>
<li>You can also check the medium channel of <a href="https://medium.com/@junanaguy">Bruce Caron</a> who writes a lot on Open Science.</li>
<li>Check the series of blog posts on Slow Science written by <a href="https://thesiswhisperer.com/">The Thesis Whisperer</a>, and particularly <a href="https://thesiswhisperer.com/2018/05/02/slow-academia-is-for-the-privileged-but-then-isnt-all-academia/?fbclid=IwAR2bS4D4flV6AeZBX176V7M6_l0-BYuN89gOboJLLDB7HYMRbEcH_JP5DrA">this one</a>: “Slow Academia is for the privileged – but then, isn’t all academia?”</li>
<li>Jonatan Godinez Madrigal (January 19, 2024). An elegy to the loser’s genuine vita activa. FLOWs. Retrieved November 15, 2024 from <a href="https://doi.org/10.58079/vmp2">https://doi.org/10.58079/vmp2</a></li>
<li>The fabulous book of Isabelle Stengers <strong>“Another Science is possible. Manifesto for a slow science”</strong> <a href="https://www.goodreads.com/book/show/35416921-another-science-is-possible">(GoodReads Page)</a> - <a href="https://hcommons.org/?get_group_doc=1003678/1700760973-AnotherScienceIsPossible_A-IsabelleStengers.pdf">(Knowledge Commons)</a> along with the book review written by Philip Conway and accessible <a href="https://www.societyandspace.org/articles/another-science-is-possible-by-isabelle-stengers">here</a>.</li>
<li>A book written by Kathleen Fitzpatrick, focusing on US universities but which content can be generalised to most Western countries:&nbsp;<strong>“Generous Thinking: A Radical Approach to Saving the University”</strong> (2019 -&nbsp;Baltimore: Johns Hopkins University Press). <a href="https://jhupbooks.press.jhu.edu/title/generous-thinking">(Publisher’s page)</a></li>
<li>Two articles [<a href="https://www.insidehighered.com/news/2016/04/19/book-argues-faculty-members-should-actively-resist-culture-speed-modern-academe">article 1</a> and <a href="https://theconversation.com/the-slow-professor-could-bring-back-creativity-to-our-universities-121170">article 2</a>] reviewing a book written about slow science in academia by two professors, Maggie Berg and Barbara K. Seeber: <strong>The Slow Professor: Challenging the Culture of Speed in the Academy</strong> (2016, 2017 - University of Toronto Press). <a href="https://utorontopress.com/us/the-slow-professor-3">(Publisher’s page)</a></li>
<li>You can find more texts and links on this <a href="https://threerottenpotatoes.wordpress.com/independent-science-2/text-links/">Rotten Potatoes</a> webpage.</li>
</ul>
</section>
<section id="in-french" class="level3">
<h3 class="anchored" data-anchor-id="in-french">In French</h3>
<ul>
<li>Un <a href="https://act.hypotheses.org/4667">billet de blog</a> “Slow science et désexcellence. Résister aux dérives néolibérales de la recherche” par Aurélia Desplain sur le blog Hypothèse “Les aspects concrets de la thèse”</li>
<li>Un <a href="https://www.pauljorion.com/blog/2011/08/23/slow-science-la-desexcellence-par-olivier-p-gosselain/">billet</a> d’Olivier P. Gosselin invité sur le blog de Paul Jorion: “Slow Science – La Désexcellence”</li>
<li>Le livre d’Isabelle Stengers <strong>« Une autre science est possible ! Manifeste pour un ralentissement des sciences »</strong> aux <a href="https://editionsladecouverte.fr/catalogue/index-Une_autre_science_est_possible__-9782707197696.html">éditions de la Découverte</a> <br> J’ai rassemblé des notes de lecture sur le livre « Une autre science est possible ! Manifeste pour un ralentissement des sciences » d’Isabelle Stengers. Elles sont accessibles sur cette page: <a href="https://yseulthb.github.io/stengers/">Notes Stengers</a>.</li>
<li>Isabelle Stengers est régulièrement invitée à la radio. Vous pouvez <a href="https://www.franceinter.fr/emissions/parenthese/parenthese-10-fevrier-2013">ici</a> écouter un très court entretien sur France Inter (8 minutes) à propos de la sortie de son livre en 2013 et des points importants qu’il contient. Ou alors <a href="https://www.franceculture.fr/emissions/du-grain-moudre/de-quoi-faut-il-sauver-la-science">ici</a> une émission plus longue de France Culture (39 minutes) où elle fut invitée avec Dominique Pestre à discuter sur la question “De quoi faut-il sauver la science?”. Plus récemment, elle fut invitée à l’émission de radio “La méthode scientifique” <a href="https://www.radiofrance.fr/franceculture/podcasts/la-methode-scientifique/grand-entretien-avec-isabelle-stengers-1654265">ici</a> sur France Culture (53 minutes). On y fait d’ailleurs mention de mes notes de lecture mentionnées plus haut! <br> Enfin dans la même veine, vous avez <a href="https://www.franceinter.fr/emissions/le-grand-face-a-face/le-grand-face-a-face-29-aout-2020?fbclid=IwAR2XIx5Dr_EqTeEJP1EjOHkMLEyYDTzy8TDS1KgD8SZT6eQZEZtBmQmGbK4">cet entretien</a> sur France Inter à nouveau (54 minutes) avec Etienne Klein, autre philosophe des sciences, venu discuter de ce qui menace l’esprit scientifique (indice: l’urgence!). Enfin, <a href="https://www.franceculture.fr/emissions/la-grande-table-idees/quel-role-joue-la-science-en-democratie?xtor=EPR-3">cet entretien</a> sur France Culture (31 minutes) avec le physicien Pierre Papon au sujet des liens entre science et démocratie à l’occasion de la sortie de son livre “La démocratie a-t-elle besoin de la science?” (et dans le cadre de la journée thématique ‘Ce que le Covid fait à la science’ sur France Culture). Bonnes écoutes!</li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>